// minimal firmware for simulation

// reset vector (first instruction at address 0)
BRA:mySimMain

#include(../../../libs/core.txt)
#include(../../../libs/flm.txt)
#include(../../pointsImported.txt)
#include(../../driver.txt)

:flt2Q29 1 29 core.lshift flm.int2flt flm.mul flm.flt2int ;

//VAR:myDataA=-0.1306657
//VAR:myDataB=0.9873754
//VAR:myDataC=-0.130124
//VAR:myDataD=0.9877024

VAR:myDataA=-2.0
VAR:myDataB=-2.0
VAR:myDataC=2.0
VAR:myDataD=2.0


:mySimMain

'myDataA @ flt2Q29 driver.fractal.setX
'myDataB @ flt2Q29 driver.fractal.setY

'myDataC @ 'myDataA @ flm.negate flm.add 1919 flm.int2flt flm.div flt2Q29
 driver.fractal.setDX 

'myDataD @ 'myDataB @ flm.negate flm.add 1079 flm.int2flt flm.div flt2Q29 
driver.fractal.setDY

50 driver.fractal.setMaxiter

// trigger a single frame
1 driver.fractal.onOff
// stop VGA (not interesting for sim) and set simFlush bit to move the electron beam to the end of the video frame
// to output the results as they become available.
2 driver.fractal.onOff

:done BRA:done
